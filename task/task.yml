---
platform: linux

image_resource:
  type: docker-image
  source:
    repository: alpinelinux/docker-cli
    tag: latest

params:
  DNS_SUFFIX: ((dnssuffix))
  DOCKER_HOST: ((dockerhost))

inputs:
  - name: consul_repo

run:
  path: sh
  args:
  - -c
  - |
    cd consul_repo
    docker stack deploy -c docker-compose.yml consul
    docker stack ls
    docker service ls
    sleep 5
